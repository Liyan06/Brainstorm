A cleaner version of the code will be available soon.
